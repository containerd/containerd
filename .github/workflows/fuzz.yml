# name: Fuzzing
# on: [pull_request]
# permissions:  # added using https://github.com/step-security/secure-workflows
#   contents: read

# jobs:
#   # Run all fuzzing tests. Some of them use Go 1.18's testing.F.
#   # Others use https://github.com/AdaLogics/go-fuzz-headers.
#   ci_fuzz:
#     name: CI Fuzz
#     if: github.repository == 'containerd/containerd'
#     runs-on: ubuntu-latest
#     timeout-minutes: 60
#     steps:
#     - name: Build Fuzzers
#       id: build
#       uses: google/oss-fuzz/infra/cifuzz/actions/build_fuzzers@c8c1b257db4da92299bdf9fd058fff1bb008b2ad # ubuntu-24-04 support
#       with:
#         oss-fuzz-project-name: 'containerd'
#         language: go
#     - name: Run Fuzzers
#       uses: google/oss-fuzz/infra/cifuzz/actions/run_fuzzers@c8c1b257db4da92299bdf9fd058fff1bb008b2ad # ubuntu-24-04 support
#       with:
#         oss-fuzz-project-name: 'containerd'
#         fuzz-seconds: 300
#         language: go
#       continue-on-error: true
#     - name: Upload Crash
#       uses: actions/upload-artifact@330a01c490aca151604b8cf639adc76d48f6c5d4 # v5.0.0
#       if: failure() && steps.build.outcome == 'success'
#       with:
#         name: artifacts
#         path: ./out/artifacts

#   # Make sure all fuzzing tests which use Go 1.18's testing.F are
#   # runnable with go test -fuzz.
#   go_test_fuzz:
#     name : go test -fuzz
#     if: github.repository == 'containerd/containerd'
#     runs-on: ubuntu-latest
#     timeout-minutes: 30
#     steps:
#       - uses: actions/checkout@8e8c483db84b4bee98b60c0593521ed34d9990e8 # v6.0.1
#       - uses: ./.github/actions/install-go
#       - run: script/go-test-fuzz.sh
